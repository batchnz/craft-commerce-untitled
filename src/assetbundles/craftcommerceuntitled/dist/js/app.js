(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{ZpdD:function(t,e,a){"use strict";a.r(e);var i=a("Kw5r"),s=a("L2JU");const n={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},r=(t="",e={})=>{const a=new URLSearchParams(e).toString();return`${Craft.getSiteUrl()+Craft.CommerceUntitled.pluginHandle}/api/${Craft.CommerceUntitled.apiVersion}/${t+(a.length>0?"?"+a:"")}`};var l=async(t={})=>await fetch(r("variant-configurations",t)),o=async(t={})=>await fetch(r("variant-configuration-types/fields",t)),c=async(t={})=>await fetch(r("variant-configurations"),{method:"POST",headers:n,body:JSON.stringify(t)}),d=async(t,e={})=>await fetch(r(`variant-configurations/${t}/variants/generate`),{method:"POST",headers:n,body:JSON.stringify(e)}),u=async(t,e={})=>await fetch(r(`products/${t}/types`),{method:"POST",headers:n,body:JSON.stringify(e)});const p=["price","stock","sku"],v=["all","skip","field"];var f=a("UGp+");const h={header:{title:"Variant Configurator",subtitle:"Select or create a variant configuration"},footer:{priBtnText:"Next Step",secBtnText:"Previous"},rules:Object(f.e)({})},_={component:"IndexStep",header:h.header,footer:{priBtnText:"Create New",secBtnText:"Cancel"},rules:h.rules},m={component:"NameStep",header:{...h.header,subtitle:"Step 1. Set the configuration name"},footer:h.footer,rules:Object(f.e)().shape({title:Object(f.f)().required("Please enter a configuration name")})},g={component:"FieldsStep",header:{...h.header,subtitle:"Step 2. Select the fields to generate variants from"},footer:h.footer,rules:Object(f.e)().shape({fields:Object(f.b)().of(Object(f.f)()).min(1,"Please select at least one field")})},S={component:"ValuesStep",header:{...h.header,subtitle:"Step 3. Select the values to generate variants from"},footer:h.footer,rules:Object(f.e)().shape({values:Object(f.b)().of(Object(f.f)()).min(1,"Please select at least one value")})},y=t=>{const e={},a=R.getters.settingsByType(t);if(null==a.field)return Object(f.e)(e);const i=R.getters.selectedOptionValuesByFieldHandle[a.field];return null==i||i.forEach(a=>{switch(t){case"price":case"stock":default:e[a]=Object(f.d)().typeError("Please enter a number").required("Please enter a value").min(0,"Please enter a value greater than 0");break;case"sku":e[a]=Object(f.f)().typeError("Please enter a value").required("Please enter a value").nullable()}}),Object(f.e)(e)},T=t=>{switch(t){case"price":case"stock":default:return Object(f.e)({value:Object(f.d)().typeError("Please enter a number").required("Please enter a value").min(0,"Please enter a value greater than 0")});case"sku":return Object(f.e)({value:Object(f.f)().typeError("Please enter a number").required("Please enter a value").min(0,"Please enter a value greater than 0").nullable()})}},b={component:"SettingsStep",header:{...h.header,subtitle:"Step 4. Set the configuration settings"},footer:{...h.footer,priBtnText:"Save Configuration"},rules:Object(f.e)().shape({settings:((t=p)=>{const e={};return t.forEach(t=>{e[t]=Object(f.e)({method:Object(f.f)().nullable().required().oneOf(v,"Please select an option"),field:Object(f.f)().when("method",{is:"field",then:Object(f.f)().nullable().required("Please select a field")}).nullable(),values:Object(f.e)().when("method",{is:"field",then:Object(f.c)(()=>y(t))}).when("method",{is:"all",then:Object(f.c)(()=>T(t))}).nullable()})}),Object(f.e)(e)})()})},C={component:"GenerateStep",header:{...h.header,subtitle:"Step 5. Generate your variants"},footer:{...h.footer,priBtnText:"Generate Variants"},rules:h.rules};var I={indexStep:_,nameStep:m,fieldsStep:g,valuesStep:S,settingsStep:b,generateStep:C};function O(){this.listeners={},this.oneTimeListeners={}}O.prototype.on=function(t,e,a=null){return E(t,e,a,this.listeners)},O.prototype.once=function(t,e,a=null){return E(t,e,a,this.oneTimeListeners)},O.prototype.emit=async function(t){let e;return e=A(this.listeners[t]),!1===e||(e=A(this.oneTimeListeners[t],!0)),e},O.prototype.off=function(t,e){N(this.listeners[t],e),N(this.oneTimeListeners[t],e)};const E=(t,e,a,i)=>{null===a&&"function"==typeof e&&(a=e,e=null),Array.isArray(i[t])||(i[t]=[]),a.bind(e),i[t].push(a)},A=async(t=[],e=!1)=>{let a=null;for(var i=0;i<t.length;i++)if("function"==typeof t[i]&&(a=await t[i](),e&&t.splice(i,1),!1===a))return a;return a},N=(t=[],e=(()=>{}))=>{for(var a=0;a<t.length;a++)t[a]===e&&t.splice(a,1)};var F=new O;i.a.use(s.a);const V={method:null,field:null,values:{}},x=()=>{const t={};return p.forEach(e=>{t[e]={...V}}),t},j=()=>({id:null,title:"",fields:[],values:[],settings:x()}),w=(t=[])=>{Array.isArray(t)||(t=[t]),t.forEach(t=>{let e=[];for(const[a,i]of Object.entries(t.values))e=e.concat(t.values[a]);t.values=e})};var R=new s.a.Store({state:{ui:{isLoading:!1,isSubmitting:!1,isCompleted:!1},step:0,totalSteps:5,formErrors:{},productId:null,productTypeId:null,typeId:null,variantConfiguration:j(),variantConfigurations:[],variantConfigurationTypeFields:[]},mutations:{SET_PRODUCT_ID(t,e){t.productId=e},SET_PRODUCT_TYPE_ID(t,e){t.productTypeId=e},SET_TYPE_ID(t,e){t.typeId=e},SET_VARIANT_CONFIGURATIONS(t,e){t.variantConfigurations=e},UPDATE_VARIANT_CONFIGURATIONS(t,e){t.variantConfigurations.forEach((a,i)=>{a.id===e.id&&(t.variantConfigurations[i]={...a,...e})})},SET_VARIANT_CONFIGURATION_TYPE_FIELDS(t,e){t.variantConfigurationTypeFields=e},SET_IS_LOADING(t,e=!0){t.ui.isLoading=e},SET_IS_SUBMITTING(t,e=!0){t.ui.isSubmitting=e},SET_IS_COMPLETED(t,e=!0){t.ui.isCompleted=e},SET_VARIANT_CONFIGURATION(t,e){t.variantConfiguration={...e}},UPDATE_VARIANT_CONFIGURATION(t,e){t.variantConfiguration={...t.variantConfiguration,...e}},SET_VARIANT_CONFIGURATION_TITLE(t,e){t.variantConfiguration.title=e},SET_VARIANT_CONFIGURATION_FIELDS(t,e){t.variantConfiguration.fields=e},SET_VARIANT_CONFIGURATION_VALUES(t,e){t.variantConfiguration.values=e},SET_VARIANT_CONFIGURATION_SETTINGS(t,e){t.variantConfiguration.settings=e},SET_VARIANT_CONFIGURATION_SETTINGS_TYPE(t,{type:e,data:a}){t.variantConfiguration.settings[e]||(t.variantConfiguration.settings[e]={}),t.variantConfiguration.settings={...t.variantConfiguration.settings,[e]:{...t.variantConfiguration.settings[e],...V,...a}}},SET_STEP(t,e){t.step=e},SET_FORM_ERRORS(t,e){t.formErrors=e}},actions:{async resetForm({commit:t,dispatch:e}){e("createNewVariantConfiguration"),t("SET_IS_COMPLETED",!1),t("SET_STEP",0)},async saveVariantConfiguration({commit:t,state:e,getters:a,dispatch:i}){t("SET_IS_SUBMITTING",!0);const s={};Object.keys(a.fieldValuesByHandle).forEach(t=>{s[t]=a.selectedOptionValuesByFieldHandle[t]||[]});const n=await c({...e.variantConfiguration,values:s,productId:e.productId,typeId:e.typeId}),{data:r}=await n.json();w(r),t("SET_VARIANT_CONFIGURATION",r),t("UPDATE_VARIANT_CONFIGURATIONS",r),t("SET_IS_SUBMITTING",!1)},async generateVariants({commit:t},e){t("SET_IS_SUBMITTING",!0);await d(e);t("SET_IS_SUBMITTING",!1)},async setCurrentVariantConfigurationById({commit:t,state:e},a){const i=e.variantConfigurations.find(t=>t.id===a);if(null==i)throw new Error("Variant Configuration not found");t("SET_VARIANT_CONFIGURATION",i),t("SET_STEP",1)},async fetchVariantConfigurations({commit:t},e){const a=await l(e),{data:i}=await a.json();w(i),t("SET_VARIANT_CONFIGURATIONS",i)},async fetchVariantConfigurationTypeFields({commit:t},e){const a=await o(e),{data:i}=await a.json();t("SET_VARIANT_CONFIGURATION_TYPE_FIELDS",i)},async toggleAllSelectedFields({commit:t,getters:e,state:a}){if(e.isAllFieldsSelected)return t("SET_VARIANT_CONFIGURATION_FIELDS",[]);const i=[];a.variantConfigurationTypeFields.forEach(t=>{i.push(t.handle)}),t("SET_VARIANT_CONFIGURATION_FIELDS",i)},async toggleAllSelectedValues({commit:t,getters:e,state:a},i){const s=e.fieldValuesByHandle[i];if(!s.length)return;let n=[];const r=a.variantConfiguration.values;n=e.isAllValuesSelected(i)?r.filter(t=>-1===s.indexOf(t)):[...r,...s],t("SET_VARIANT_CONFIGURATION_VALUES",n)},async nextStep({commit:t,getters:e,state:a,dispatch:i}){const{rules:s}=e.currentStepState;if(!await i("validate",{schema:s,values:a.variantConfiguration}))return;!1!==await F.emit("form-submission")&&(a.step>=a.totalSteps||t("SET_STEP",a.step+1))},async prevStep({commit:t,state:e}){e.step<0||t("SET_STEP",e.step-1)},async menuStep({commit:t,dispatch:e}){e("resetForm")},async validate({commit:t,getters:e,state:a},{schema:i,values:s}){try{t("SET_FORM_ERRORS",{}),await i.validate(s,{abortEarly:!1})}catch(e){return e.inner&&e.inner.forEach(e=>{t("SET_FORM_ERRORS",{...a.formErrors,[e.path]:e.message})}),!1}return!0},async createNewVariantConfiguration({commit:t,dispatch:e}){await e("clearFormErrors"),t("SET_VARIANT_CONFIGURATION",j())},async clearFormErrors({commit:t}){t("SET_FORM_ERRORS",{})}},getters:{settingsByType:t=>e=>t.variantConfiguration.settings[e]||{},isAllFieldsSelected(t){const e=t.variantConfigurationTypeFields.map(t=>t.handle);return e.filter(e=>t.variantConfiguration.fields.includes(e)).length===e.length},isAllValuesSelected:(t,e)=>a=>{const i=e.fieldValuesByHandle[a];return i.filter(e=>t.variantConfiguration.values.includes(e)).length===i.length},selectedFields:t=>t.variantConfigurationTypeFields.filter(e=>t.variantConfiguration.fields.includes(e.handle)),selectedOptionsByFieldHandle(t,e){const a={};return e.selectedFields.forEach(e=>{a[e.handle]=[],e.values.forEach(i=>{t.variantConfiguration.values.includes(i.value)&&a[e.handle].push(i)})}),a},fieldValuesByHandle(t){const e={};return t.variantConfigurationTypeFields.forEach(t=>{e[t.handle]=t.values.map(({value:t})=>t)}),e},optionValuesById(t){const e={};return t.variantConfigurationTypeFields.forEach(t=>{t.values.forEach(t=>{e[t.value]=t.label})}),e},selectedOptionValuesByFieldHandle(t,e){const a={};return e.selectedFields.forEach(e=>{a[e.handle]=[],e.values.forEach(i=>{t.variantConfiguration.values.includes(i.value)&&a[e.handle].push(i.value)})}),a},currentStepState:(t,e)=>e.stepState(t.step),stepState:(t,e)=>t=>{switch(t){case 0:default:return I.indexStep;case 1:return I.nameStep;case 2:return I.fieldsStep;case 3:return I.valuesStep;case 4:return I.settingsStep;case 5:return I.generateStep}},defaultSettings:()=>V}}),P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"body"},[a("div",{staticClass:"content-summary"},[a("AppHeader",{attrs:{title:t.state.header.title,subtitle:t.state.header.subtitle}})],1),t._v(" "),t.isLoading?a("AppLoading"):t._e(),t._v(" "),t.isLoading?t._e():a(t.state.component,{tag:"component"})],1),t._v(" "),a("AppFooter",{attrs:{isLoading:t.isLoading,isSubmitting:t.isSubmitting,isCompleted:t.isCompleted,priBtnText:t.state.footer.priBtnText,secBtnText:t.state.footer.secBtnText,step:t.step},on:{"close-modal":t.handleCloseModal}})],1)};P._withStripped=!0;var B=function(){var t=this.$createElement;this._self._c;return this._m(0)};B._withStripped=!0;var U={},G=a("KHd+"),k=Object(G.a)(U,B,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{display:"flex","align-items":"center"}},[this._v("\n  Loading...\n  "),e("span",{staticClass:"spinner"})])}],!1,null,null,null);k.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/AppLoading.vue";var L=k.exports,D=function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h1",{staticStyle:{"font-size":"20px","font-weight":"bold"}},[this._v("\n    "+this._s(this.title)+"\n  ")]),this._v(" "),e("p",{staticStyle:{"margin-bottom":"2rem !important"}},[this._v("\n    "+this._s(this.subtitle)+"\n  ")])])};D._withStripped=!0;var H={props:{title:String,subtitle:String}},M=Object(G.a)(H,D,[],!1,null,null,null);M.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/AppHeader.vue";var q=M.exports,Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"footer"},[t.step>0?a("div",{staticClass:"buttons left"},[a("button",{staticClass:"btn icon nav",on:{click:t.menuStep}},[t._v("Menu")])]):t._e(),t._v(" "),t.isCompleted?a("div",{staticClass:"buttons right"},[a("button",{staticClass:"btn submit",on:{click:function(e){return t.$emit("close-modal")}}},[t._v("Finish")])]):a("div",{staticClass:"buttons right"},[a("button",{staticClass:"btn",on:{click:t.handleSecBtnClick}},[t._v("\n      "+t._s(t.secBtnText)+"\n    ")]),t._v(" "),a("button",{staticClass:"btn submit",class:{disabled:t.isLoading,add:t.isSubmitting,icon:t.isSubmitting,loading:t.isSubmitting},attrs:{disabled:t.isLoading||t.isSubmitting},on:{click:t.nextStep}},[t._v("\n      "+t._s(t.priBtnText)+"\n    ")])])])};Y._withStripped=!0;var J={props:{isLoading:Boolean,isSubmitting:Boolean,isCompleted:Boolean,priBtnText:String,secBtnText:String,step:Number},methods:{...Object(s.b)(["nextStep","prevStep","menuStep"]),handleSecBtnClick(){0===this.step?this.$emit("close-modal"):this.prevStep()}}},z=Object(G.a)(J,Y,[],!1,null,null,null);z.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/AppFooter.vue";var K=z.exports,W=function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("table",{ref:"table",staticClass:"display data",attrs:{id:"variant_configurations"}},[this._m(0),this._v(" "),e("tbody")])])};W._withStripped=!0;var X={data:()=>({dt:null}),computed:Object(s.e)({variantConfigurations:t=>t.variantConfigurations,dtData(){const t=[];return this.variantConfigurations.forEach(e=>{const a=null==e.dateUpdated?null:new Date(e.dateUpdated).toLocaleDateString();t.push([e.id,e.title,e.numberOfVariants,a])}),t}}),created(){F.once("form-submission",this.createNewVariantConfiguration)},mounted(){const t=this;this.$nextTick(()=>{this.dt=$(this.$refs.table).DataTable({data:this.dtData,columnDefs:[{targets:[0],visible:!1,searchable:!1}]}),$(".dataTable").on("click","tbody tr",(function(){const e=t.dt.row(this).data();t.clearFormErrors(),t.setCurrentVariantConfigurationById(e[0])}))})},methods:{...Object(s.b)(["setCurrentVariantConfigurationById","createNewVariantConfiguration","clearFormErrors"])},beforeDestroy(){this.dt.destroy(),F.off("form-submission",this.createNewVariantConfiguration)}},Z=Object(G.a)(X,W,[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("ID")]),this._v(" "),e("th",[this._v("Name")]),this._v(" "),e("th",[this._v("Number of Variants")]),this._v(" "),e("th",[this._v("Last Updated")])])])}],!1,null,null,null);Z.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/IndexStep.vue";var Q=Z.exports,tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("form",{staticClass:"field width-100"},[t._m(0),t._v(" "),t._m(1),t._v(" "),a("div",{staticClass:"input ltr",class:{errors:t.errors.title}},[a("textarea",{staticClass:"nicetext text",staticStyle:{"min-height":"32px"},attrs:{id:"configuration-name",name:"title",rows:"1",cols:"50",placeholder:""},on:{input:function(e){return t.handleInput(e.target.value)}}},[t._v(t._s(t.title))]),t._v(" "),t.errors.title?a("ul",{staticClass:"errors"},[a("li",[t._v(t._s(t.errors.title))])]):t._e()])])};tt._withStripped=!0;var et={computed:Object(s.e)({title:t=>t.variantConfiguration.title,errors:t=>t.formErrors}),methods:{...Object(s.d)({setTitle:"SET_VARIANT_CONFIGURATION_TITLE"}),...Object(s.b)(["validate"]),async handleInput(t){const{rules:e}=m;await this.validate({values:{title:t},schema:e}),this.setTitle(t)}}},at=Object(G.a)(et,tt,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"heading"},[e("label",{attrs:{for:"configuration-name"}},[this._v("Name")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"instructions",attrs:{id:"configuration-name-instructions"}},[e("p",[this._v('Give your configuration a name e.g. "Accent Colours"')])])}],!1,null,null,null);at.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/NameStep.vue";var it=at.exports,st=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"field width-100"},[a("div",{staticClass:"heading"},[a("label",{attrs:{for:"configuration-fields"}},[t._v("Fields\n      "),a("a",{staticStyle:{"font-size":"11px","font-weight":"normal","margin-left":"2px"},attrs:{href:"#"},on:{click:t.toggleAllSelectedFields}},[t._v(t._s(t.isAllSelected?"Unselect all":"Select all"))])])]),t._v(" "),a("div",{staticClass:"input ltr",class:{errors:t.errors.fields}},[a("fieldset",{staticClass:"checkbox-group"},t._l(t.fields,(function(e){return a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.variantFields,expression:"variantFields"}],staticClass:"checkbox",attrs:{type:"checkbox",name:"fields[]",id:"fields-"+e.handle},domProps:{value:e.handle,checked:Array.isArray(t.variantFields)?t._i(t.variantFields,e.handle)>-1:t.variantFields},on:{change:function(a){var i=t.variantFields,s=a.target,n=!!s.checked;if(Array.isArray(i)){var r=e.handle,l=t._i(i,r);s.checked?l<0&&(t.variantFields=i.concat([r])):l>-1&&(t.variantFields=i.slice(0,l).concat(i.slice(l+1)))}else t.variantFields=n}}}),t._v(" "),a("label",{attrs:{for:"fields-"+e.handle}},[t._v("\n          "+t._s(e.name)+"\n        ")])])})),0),t._v(" "),t.errors.fields?a("ul",{staticClass:"errors"},[a("li",[t._v(t._s(t.errors.fields))])]):t._e()])])};st._withStripped=!0;var nt={computed:{...Object(s.e)({fields:t=>t.variantConfigurationTypeFields,errors:t=>t.formErrors}),...Object(s.c)({isAllSelected:"isAllFieldsSelected"}),variantFields:{get(){return this.$store.state.variantConfiguration.fields},async set(t){const{rules:e}=g;await this.validate({values:{fields:t},schema:e}),this.setFields(t)}}},methods:{...Object(s.d)({setFields:"SET_VARIANT_CONFIGURATION_FIELDS"}),...Object(s.b)(["toggleAllSelectedFields","validate"])}},rt=Object(G.a)(nt,st,[],!1,null,null,null);rt.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/FieldsStep.vue";var lt=rt.exports,ot=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",t._l(t.selectedFields,(function(e){return a("div",{staticClass:"field width-100"},[a("div",{staticClass:"heading"},[a("label",{attrs:{for:"configuration-fields"}},[t._v(t._s(e.name)+"\n        "),a("a",{staticStyle:{"font-size":"11px","font-weight":"normal","margin-left":"2px"},attrs:{href:"#"},on:{click:function(a){return t.handleToggleValues(e.handle)}}},[t._v(t._s(t.isAllSelected(e.handle)?"Unselect all":"Select all"))])])]),t._v(" "),a("div",{staticClass:"input ltr",class:{errors:t.errors.values}},[a("fieldset",{staticClass:"checkbox-group",staticStyle:{display:"flex","flex-wrap":"wrap"}},t._l(e.values,(function(e){var i=e.label,s=e.value;return a("div",{staticStyle:{width:"25%"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.values,expression:"values"}],staticClass:"checkbox",attrs:{type:"checkbox",id:"fields-"+s,name:"fields[]"},domProps:{value:s,checked:Array.isArray(t.values)?t._i(t.values,s)>-1:t.values},on:{change:function(e){var a=t.values,i=e.target,n=!!i.checked;if(Array.isArray(a)){var r=s,l=t._i(a,r);i.checked?l<0&&(t.values=a.concat([r])):l>-1&&(t.values=a.slice(0,l).concat(a.slice(l+1)))}else t.values=n}}}),t._v(" "),a("label",{attrs:{for:"fields-"+s}},[t._v("\n            "+t._s(i)+"\n          ")])])})),0),t._v(" "),t.errors.values?a("ul",{staticClass:"errors"},[a("li",[t._v(t._s(t.errors.values))])]):t._e()])])})),0)};ot._withStripped=!0;var ct={computed:{...Object(s.e)({fields:t=>t.variantConfigurationTypeFields,errors:t=>t.formErrors,variantValues:t=>t.variantConfiguration.values,variantFields:t=>t.variantConfiguration.fields}),...Object(s.c)({selectedFields:"selectedFields",isAllSelected:"isAllValuesSelected"}),values:{get(){return this.variantValues},async set(t){await this.isValid(t),this.setValues(t)}}},methods:{...Object(s.b)(["toggleAllSelectedValues","validate"]),...Object(s.d)({setValues:"SET_VARIANT_CONFIGURATION_VALUES"}),handleToggleValues(t){this.toggleAllSelectedValues(t),this.isValid(this.variantValues)},async isValid(t){const{rules:e}=S;return await this.validate({values:{values:t},schema:e})}}},dt=Object(G.a)(ct,ot,[],!1,null,null,null);dt.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/ValuesStep.vue";var ut=dt.exports,pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",t._l(t.types,(function(e,i){return a("div",[a("AppSettings",{attrs:{type:e}}),t._v(" "),i<t.types.length-1?a("hr"):t._e()],1)})),0)};pt._withStripped=!0;var vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"field"},[a("div",{staticClass:"heading"},[a("label",[t._v(t._s(t.typeTitle))]),t._v(" "),a("div",{staticClass:"instructions"},[t._v("\n      "+t._s(t.typeInstructions)+"\n    ")])]),t._v(" "),a("div",{staticClass:"input ltr"},[a("fieldset",[a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.method,expression:"method"}],staticClass:"radio",attrs:{type:"radio",id:"settings-"+t.type+"-all",name:"settings["+t.type+"][method]",value:"all"},domProps:{checked:t._q(t.method,"all")},on:{change:function(e){t.method="all"}}}),t._v(" "),a("label",{attrs:{for:"settings-"+t.type+"-all"}},[t._v("Set "+t._s(t.typeTitle)+" for all variants")])]),t._v(" "),"all"===t.method?a("div",{staticClass:"field",staticStyle:{"margin-left":"32px"}},[a("div",{staticClass:"heading"},[a("label",[t._v(t._s(t.typeTitle))])]),t._v(" "),a("div",{staticClass:"input ltr"},["price"===t.type?a("div",{staticClass:"flex"},[a("div",[t._v("$")]),t._v(" "),a("input",{staticClass:"nicetext text",attrs:{type:"text"},domProps:{value:t.values.value},on:{input:function(e){return t.setFieldValue("value",e.target.value)}}})]):a("input",{staticClass:"nicetext text",attrs:{type:"text"},domProps:{value:t.values.value},on:{input:function(e){return t.setFieldValue("value",e.target.value)}}})]),t._v(" "),t.errors["settings."+t.type+".values.value"]?a("ul",{staticClass:"errors"},[a("li",[t._v(t._s(t.errors["settings."+t.type+".values.value"]))])]):t._e()]):t._e(),t._v(" "),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.method,expression:"method"}],staticClass:"radio",attrs:{type:"radio",id:"settings-"+t.type+"-field",name:"settings["+t.type+"][method]",value:"field"},domProps:{checked:t._q(t.method,"field")},on:{change:function(e){t.method="field"}}}),t._v(" "),a("label",{attrs:{for:"settings-"+t.type+"-field"}},[t._v("Set "+t._s(t.typeTitle)+" per field")])]),t._v(" "),"field"===t.method?a("div",{staticClass:"field",staticStyle:{"margin-left":"32px"}},[t._m(0),t._v(" "),a("div",{staticClass:"input ltr"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.field,expression:"field"}],attrs:{name:"",id:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.field=e.target.multiple?a:a[0]}}},[a("option",{domProps:{value:null}},[t._v("Select")]),t._v(" "),t._l(t.selectedFields,(function(e){return t.selectedValuesByHandle[e.handle].length?a("option",{domProps:{value:e.handle}},[t._v("\n              "+t._s(e.name)+"\n            ")]):t._e()}))],2)]),t._v(" "),t.errors["settings."+t.type+".field"]?a("ul",{staticClass:"errors"},[a("li",[t._v(t._s(t.errors["settings."+t.type+".field"]))])]):t._e(),t._v(" "),t._l(t.selectedValuesByHandle[t.field],(function(e){var i=e.label,s=e.value;return t.field?a("div",{staticClass:"field"},[a("div",{staticClass:"heading"},[a("label",[t._v(t._s(i))])]),t._v(" "),a("div",{staticClass:"input ltr"},["price"===t.type?a("div",{staticClass:"flex"},[a("div",[t._v("$")]),t._v(" "),a("input",{staticClass:"nicetext text",attrs:{type:"text"},domProps:{value:t.values[s]},on:{input:function(e){return t.setFieldValue(s,e.target.value)}}})]):a("input",{staticClass:"nicetext text",attrs:{type:"text"},domProps:{value:t.values[s]},on:{input:function(e){return t.setFieldValue(s,e.target.value)}}})]),t._v(" "),t.errors["settings."+t.type+".values."+s]?a("ul",{staticClass:"errors"},[a("li",[t._v(t._s(t.errors["settings."+t.type+".values."+s]))])]):t._e()]):t._e()}))],2):t._e(),t._v(" "),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.method,expression:"method"}],staticClass:"radio",attrs:{type:"radio",id:"settings-"+t.type+"-skip",name:"settings["+t.type+"][method]",value:"skip"},domProps:{checked:t._q(t.method,"skip")},on:{change:function(e){t.method="skip"}}}),t._v(" "),a("label",{attrs:{for:"settings-"+t.type+"-skip"}},[t._v("Skip "+t._s(t.typeTitle))])])]),t._v(" "),t.errors["settings."+t.type+".method"]?a("ul",{staticClass:"errors"},[a("li",[t._v(t._s(t.errors["settings."+t.type+".method"]))])]):t._e()])])};vt._withStripped=!0;var ft={props:{type:{type:String,required:!0}},computed:{...Object(s.e)({variantSettings(t){return t.variantConfiguration.settings[this.type]||this.defaultSettings},errors:t=>t.formErrors}),...Object(s.c)({defaultSettings:"defaultSettings",selectedFields:"selectedFields",selectedValuesByHandle:"selectedOptionsByFieldHandle"}),typeTitle(){const t=Craft.t("craft-commerce-untitled",this.type);return t.charAt(0).toUpperCase()+t.slice(1)},typeInstructions(){switch(this.type){case"sku":return`Use ${this.templateVars} to dynamically set ${this.typeTitle} from field values`;default:return""}},templateVars(){return this.selectedFields.map(t=>`{${t.handle}}`).join(", ")},method:{get(){return this.variantSettings.method},async set(t){const e={...this.variantSettings,method:t};this.setSettingsType({type:this.type,data:e})}},field:{get(){return this.variantSettings.field},async set(t){const e={...this.variantSettings,field:t};this.setSettingsType({type:this.type,data:e})}},values:{get(){return this.variantSettings.values},async set(t){const e={...this.variantSettings,values:t};this.setSettingsType({type:this.type,data:e})}}},methods:{...Object(s.b)(["validate"]),...Object(s.d)({setSettingsType:"SET_VARIANT_CONFIGURATION_SETTINGS_TYPE"}),setFieldValue(t,e){const a={},i=this.variantSettings.values;null==e||""==e?delete i[t]:a[t]=e;const s={...this.variantSettings,values:{...i,...a}};this.setSettingsType({type:this.type,data:s})}}},ht=Object(G.a)(ft,vt,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"heading"},[e("label",[this._v("Choose a field")])])}],!1,null,null,null);ht.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/AppSettings.vue";var _t=ht.exports,mt={created(){F.once("form-submission",this.saveVariantConfiguration)},computed:{types:()=>p},methods:{...Object(s.b)(["saveVariantConfiguration"])},beforeDestroy(){F.off("form-submission",this.saveVariantConfiguration)},components:{AppSettings:_t}},gt=Object(G.a)(mt,pt,[],!1,null,null,null);gt.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/SettingsStep.vue";var St=gt.exports,yt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isGenerating?a("div",[a("h2",[t._v("Hold Tight!")]),t._v(" "),t._m(2)]):a("div",[a("h2",{staticStyle:{"margin-bottom":"5px"}},[t._v("Config Summary")]),t._v(" "),a("div",{staticStyle:{"margin-bottom":"16px"}},[t._v("The following config will be saved:")]),t._v(" "),a("div",{staticClass:"field",staticStyle:{"margin-bottom":"16px 0"}},[t._m(0),t._v(" "),a("div",{staticStyle:{"margin-bottom":"16px"}},[t._v(t._s(t.variantConfiguration.title))]),t._v(" "),t._l(t.selectedFields,(function(e){return a("div",[a("div",{staticStyle:{"margin-bottom":"5px","font-weight":"bold",color:"#606d7b"}},[t._v("\n        "+t._s(e.name)+"\n      ")]),t._v(" "),a("ul",{staticStyle:{margin:"0 0 16px 16px","list-style-type":"disc"}},t._l(t.selectedOptionsByFieldHandle[e.handle],(function(e){var i=e.label;e.value;return a("li",[t._v("\n          "+t._s(i)+"\n        ")])})),0)])})),t._v(" "),t._m(1),t._v(" "),t._l(t.types,(function(e){return a("ul",{staticStyle:{margin:"0 0 0 16px","list-style-type":"disc"}},["all"===t.variantConfiguration.settings[e].method?a("li",[t._v("\n        "+t._s(t.getTitle(e))+" - "+t._s("price"===e?"$":"")+t._s(t.variantConfiguration.settings[e].values.value)+"\n        for all variants\n      ")]):t._e(),t._v(" "),"field"===t.variantConfiguration.settings[e].method?[a("li",[t._v(t._s(t.getTitle(e))+" - Per field")]),t._v(" "),a("ul",{staticStyle:{"margin-left":"16px","list-style-type":"revert"}},t._l(t.variantConfiguration.settings[e].values,(function(i,s){return"value"!==s?a("li",[t._v("\n            "+t._s(t.optionValuesById[s])+" - "+t._s("price"===e?"$":"")+t._s(i)+"\n          ")]):t._e()})),0)]:t._e(),t._v(" "),"skip"===t.variantConfiguration.settings[e].method?a("li",[t._v("\n        "+t._s(t.getTitle(e))+" - Skipped\n      ")]):t._e()],2)}))],2)])};yt._withStripped=!0;var Tt={data:()=>({isGenerating:!1}),computed:{...Object(s.e)({variantConfiguration:t=>t.variantConfiguration}),...Object(s.c)(["selectedFields","selectedOptionsByFieldHandle","fieldValuesByHandle","optionValuesById"]),types:()=>p},created(){F.once("form-submission",this,this.handleGenerateVariants)},beforeDestroy(){F.off("form-submission",this.handleGenerateVariants)},methods:{...Object(s.b)(["generateVariants"]),...Object(s.d)({setIsCompleted:"SET_IS_COMPLETED"}),getTitle:(t="")=>t.charAt(0).toUpperCase()+t.slice(1),async handleGenerateVariants(){await this.generateVariants(this.variantConfiguration.id),this.setIsCompleted(),this.isGenerating=!0}}},bt=Object(G.a)(Tt,yt,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"heading"},[e("label",[this._v("Title")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"heading"},[e("label",[this._v("Settings")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("\n    Please wait while your variants are generated."),e("br"),this._v("\n    This can take several minutes and you can monitor progress on the queue\n    jobs page.\n  ")])}],!1,null,null,null);bt.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/GenerateStep.vue";var Ct=bt.exports,It={props:{productId:Number,productTypeId:Number,variantConfigurationTypeId:Number,$modal:Object},computed:{...Object(s.e)({isLoading:t=>t.ui.isLoading,isSubmitting:t=>t.ui.isSubmitting,isCompleted:t=>t.ui.isCompleted,step:t=>t.step}),...Object(s.c)({state:"currentStepState"})},async created(){this.setIsLoading(!0),this.setProductId(this.productId),this.setProductTypeId(this.productTypeId),this.setTypeId(this.variantConfigurationTypeId),await this.fetchVariantConfigurations({productId:this.productId}),await this.fetchVariantConfigurationTypeFields({productTypeId:this.productTypeId}),this.setIsLoading(!1)},methods:{...Object(s.b)(["fetchVariantConfigurations","fetchVariantConfigurationTypeFields"]),...Object(s.d)({setIsLoading:"SET_IS_LOADING",setProductId:"SET_PRODUCT_ID",setProductTypeId:"SET_PRODUCT_TYPE_ID",setTypeId:"SET_TYPE_ID"}),handleCloseModal(){this.$modal.hide()}},components:{AppLoading:L,AppHeader:q,AppFooter:K,IndexStep:Q,NameStep:it,FieldsStep:lt,ValuesStep:ut,SettingsStep:St,GenerateStep:Ct}},Ot=Object(G.a)(It,P,[],!1,null,null,null);Ot.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/App.vue";var Et=Ot.exports;!function(t){t.fn.dataTable.ext.classes.sPageButton=t.fn.dataTable.ext.classes.sPageButton+" btn",t.fn.dataTable.ext.classes.sPageButtonActive="active",t.fn.dataTable.ext.classes.sFilterInput="text dataTables_filter__input",t.fn.dataTable.ext.classes.sSortAsc="ordered asc",t.fn.dataTable.ext.classes.sSortColumn="ordered",t.fn.dataTable.ext.classes.sSortDesc="ordered desc",Craft.CommerceUntitled=Garnish.Base.extend({settings:{productId:null,productTypeId:null,variantConfigurationTypeId:null,productVariantType:"standard"},$dt:t(),init(e){this.settings=t.extend({},Craft.CommerceUntitled.defaults,e),"standard"!==this.settings.productVariantType&&(this.initEditBtn(),this.initDataTables()),this.handleVariantTypeChange()},initEditBtn(){const e=t(this.getEditBtnHtml());t("#header").find(".btngroup:first").before(e),e.on("click",t=>{t.preventDefault(),new Craft.VariantConfigurationModal({productId:this.settings.productId,productTypeId:this.settings.productTypeId,variantConfigurationTypeId:this.settings.variantConfigurationTypeId,onClose:t=>{t.$destroy(),R.dispatch("resetForm"),this.$dt.ajax.reload()}})})},initDataTables(){const e=this.settings.productId;this.$dt=t("#configurable-variants").DataTable({autoWidth:!1,ajax:"/craft-commerce-untitled/api/v1/variants?productId="+e})},handleVariantTypeChange(){const e=this.settings.productId;t("#variant-type-field").find("select").on("change",t=>{const a=t.target.value;u(e,{variantType:a}).then(()=>{window.location.reload()})})},getEditBtnHtml:()=>'<button class="btn secondary">Edit Configurations</button>'}),Craft.VariantConfigurationModal=Garnish.Modal.extend({settings:{productId:null,productTypeId:null,variantConfigurationTypeId:null,onClose:()=>{}},closeOtherModals:!0,shadeClass:"modal-shade dark",init(e){this.setSettings(e,Craft.VariantConfigurationModal.defaults),this.$container=t('<div class="modal elementselectormodal">\n          <div id="variant-configuration-modal-container" style="height: 100%; overflow-y: auto; overscroll-behavior: contain;">\n            <div id="variant-configuration-app" />\n          </div>\n        </div>').appendTo(Garnish.$bod);const a=new i.a({el:"#variant-configuration-app",store:R,render:t=>t(Et,{props:{productId:this.settings.productId,productTypeId:this.settings.productTypeId,variantConfigurationTypeId:this.settings.variantConfigurationTypeId,$modal:this}})});this.on("hide",()=>{this.settings.onClose(a)}),this.base(this.$container,e)}})}(jQuery)}},[["ZpdD",1,2]]]);