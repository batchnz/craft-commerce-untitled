(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{ZpdD:function(e,t,a){"use strict";a.r(t);var i=a("Kw5r"),s=a("L2JU");const n={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},r=(e="",t={})=>{const a=new URLSearchParams(t).toString();return`/${Craft.CommerceUntitled.pluginHandle}/api/${Craft.CommerceUntitled.apiVersion}/${e+(a.length>0?"?"+a:"")}`};var l=async(e={})=>await fetch(r("variant-configurations",e)),o=async(e={})=>await fetch(r("variant-configuration-types/fields",e)),c=async(e={})=>await fetch(r("variant-configurations"),{method:"POST",headers:n,body:JSON.stringify(e)}),d=async(e,t={})=>await fetch(r(`variant-configurations/${e}/variants/generate`),{method:"POST",headers:n,body:JSON.stringify(t)}),u=async(e,t={})=>await fetch(r(`products/${e}/types`),{method:"POST",headers:n,body:JSON.stringify(t)}),p=async e=>await fetch(r(`variant-configurations/${e}/variants/delete`),{method:"POST",headers:n,body:JSON.stringify({})});const v=["price","stock","sku","minQty","maxQty"],h=["weight","length","width","height"],f=["all","skip","field"];var m=a("UGp+");const _={header:{title:"Variant Configurator",subtitle:"Select or create a variant configuration"},footer:{priBtnText:"Next Step",secBtnText:"Previous"},rules:Object(m.e)({})},g={component:"IndexStep",header:_.header,footer:{priBtnText:"Create New",secBtnText:"Cancel"},rules:_.rules},S={component:"NameStep",header:{..._.header,subtitle:"Step 1. Set the configuration name"},footer:_.footer,rules:Object(m.e)().shape({title:Object(m.f)().required("Please enter a configuration name")})},y={component:"FieldsStep",header:{..._.header,subtitle:"Step 2. Select the fields to generate variants from"},footer:_.footer,rules:Object(m.e)().shape({fields:Object(m.b)().of(Object(m.f)()).min(1,"Please select at least one field")})},T={component:"ValuesStep",header:{..._.header,subtitle:"Step 3. Select the values to generate variants from"},footer:_.footer,rules:Object(m.e)().shape({values:Object(m.b)().of(Object(m.f)()).min(1,"Please select at least one value")})},C=e=>{const t={},a=P.getters.settingsByType(e);if(null==a.field)return Object(m.e)(t);const i=P.getters.selectedOptionValuesByFieldHandle[a.field];return null==i||i.forEach(a=>{switch(e){case"price":case"stock":case"weight":case"height":case"length":case"width":case"minQty":case"maxQty":default:t[a]=Object(m.d)().typeError("Please enter a number").required("Please enter a value").min(0,"Please enter a value greater than 0");break;case"sku":t[a]=Object(m.f)().typeError("Please enter a value").required("Please enter a value").nullable()}}),Object(m.e)(t)},b=e=>{switch(e){case"price":case"stock":case"weight":case"height":case"length":case"width":case"minQty":case"maxQty":default:return Object(m.e)({value:Object(m.d)().typeError("Please enter a number").required("Please enter a value").min(0,"Please enter a value greater than 0")});case"sku":return Object(m.e)({value:Object(m.f)().typeError("Please enter a number").required("Please enter a value").min(0,"Please enter a value greater than 0").nullable()})}},I={component:"SettingsStep",header:{..._.header,subtitle:"Step 4. Set the configuration settings"},footer:{..._.footer,priBtnText:"Save Configuration"},rules:Object(m.e)().shape({settings:Object(m.c)(()=>(()=>{const e={};return P.getters.allowedTypes.forEach(t=>{e[t]=Object(m.e)({method:Object(m.f)().nullable().required("Please select an option").oneOf(f,"Please select an option"),field:Object(m.f)().when("method",{is:"field",then:Object(m.f)().nullable().required("Please select a field")}).nullable(),values:Object(m.e)().when("method",{is:"field",then:Object(m.c)(()=>C(t))}).when("method",{is:"all",then:Object(m.c)(()=>b(t))}).nullable()})}),Object(m.e)(e)})())})},O={component:"GenerateStep",header:{..._.header,subtitle:"Step 5. Generate your variants"},footer:{..._.footer,priBtnText:"Generate Variants"},rules:_.rules};var E={indexStep:g,nameStep:S,fieldsStep:y,valuesStep:T,settingsStep:I,generateStep:O};function A(){this.listeners={},this.oneTimeListeners={}}A.prototype.on=function(e,t,a=null){return N(e,t,a,this.listeners)},A.prototype.once=function(e,t,a=null){return N(e,t,a,this.oneTimeListeners)},A.prototype.emit=async function(e){let t;return t=w(this.listeners[e]),!1===t||(t=w(this.oneTimeListeners[e],!0)),t},A.prototype.off=function(e,t){V(this.listeners[e],t),V(this.oneTimeListeners[e],t)};const N=(e,t,a,i)=>{null===a&&"function"==typeof t&&(a=t,t=null),Array.isArray(i[e])||(i[e]=[]),a.bind(t),i[e].push(a)},w=async(e=[],t=!1)=>{let a=null;for(var i=0;i<e.length;i++)if("function"==typeof e[i]&&(a=await e[i](),t&&e.splice(i,1),!1===a))return a;return a},V=(e=[],t=(()=>{}))=>{for(var a=0;a<e.length;a++)e[a]===t&&e.splice(a,1)};var F=new A;i.a.use(s.a);const x={method:null,field:null,values:{}},j=()=>{const e={};return v.forEach(t=>{e[t]={...x}}),e},R=()=>({id:null,title:"",fields:[],values:[],settings:j()}),D=(e=[])=>{Array.isArray(e)||(e=[e]),e.forEach(e=>{let t=[];for(const[a,i]of Object.entries(e.values))t=t.concat(e.values[a]);e.values=t.map(e=>e.toString())})};var P=new s.a.Store({state:{ui:{isLoading:!1,isSubmitting:!1,isCompleted:!1},step:0,totalSteps:5,formErrors:{},productId:null,productTypeId:null,typeId:null,variantConfiguration:R(),variantConfigurations:[],variantConfigurationTypeFields:[],hasDimensions:null},mutations:{SET_PRODUCT_ID(e,t){e.productId=t},SET_PRODUCT_TYPE_ID(e,t){e.productTypeId=t},SET_TYPE_ID(e,t){e.typeId=t},SET_VARIANT_CONFIGURATIONS(e,t){e.variantConfigurations=t},SET_HAS_DIMENSIONS(e,t){e.hasDimensions=t},UPDATE_VARIANT_CONFIGURATIONS(e,t){e.variantConfigurations.forEach((a,i)=>{a.id===t.id&&(e.variantConfigurations[i]={...a,...t})})},SET_VARIANT_CONFIGURATION_TYPE_FIELDS(e,t){e.variantConfigurationTypeFields=t},SET_IS_LOADING(e,t=!0){e.ui.isLoading=t},SET_IS_SUBMITTING(e,t=!0){e.ui.isSubmitting=t},SET_IS_COMPLETED(e,t=!0){e.ui.isCompleted=t},SET_VARIANT_CONFIGURATION(e,t){e.variantConfiguration={...t}},UPDATE_VARIANT_CONFIGURATION(e,t){e.variantConfiguration={...e.variantConfiguration,...t}},SET_VARIANT_CONFIGURATION_TITLE(e,t){e.variantConfiguration.title=t},SET_VARIANT_CONFIGURATION_FIELDS(e,t){e.variantConfiguration.fields=t},SET_VARIANT_CONFIGURATION_VALUES(e,t){e.variantConfiguration.values=t},SET_VARIANT_CONFIGURATION_SETTINGS(e,t){e.variantConfiguration.settings=t},SET_VARIANT_CONFIGURATION_SETTINGS_TYPE(e,{type:t,data:a}){e.variantConfiguration.settings[t]||(e.variantConfiguration.settings[t]={}),e.variantConfiguration.settings={...e.variantConfiguration.settings,[t]:{...e.variantConfiguration.settings[t],...x,...a}}},SET_STEP(e,t){e.step=t},SET_FORM_ERRORS(e,t){e.formErrors=t}},actions:{async resetForm({commit:e,dispatch:t}){t("createNewVariantConfiguration"),e("SET_IS_COMPLETED",!1),e("SET_STEP",0)},async saveVariantConfiguration({commit:e,state:t,getters:a,dispatch:i}){e("SET_IS_SUBMITTING",!0);const s={};Object.keys(a.fieldValuesByHandle).forEach(e=>{s[e]=a.selectedOptionValuesByFieldHandle[e]||[]});const n=await c({...t.variantConfiguration,values:s,productId:t.productId,typeId:t.typeId}),{data:r}=await n.json();D(r),e("SET_VARIANT_CONFIGURATION",r),e("UPDATE_VARIANT_CONFIGURATIONS",r),e("SET_IS_SUBMITTING",!1)},async generateVariants({commit:e},t){e("SET_IS_SUBMITTING",!0);await d(t);e("SET_IS_SUBMITTING",!1)},async deleteVariantConfiguration({commit:e},t){e("SET_IS_SUBMITTING",!0);const a=await p(t);return e("SET_IS_SUBMITTING",!1),a},async setCurrentVariantConfigurationById({commit:e,state:t},a){const i=t.variantConfigurations.find(e=>e.id===a);if(null==i)throw new Error("Variant Configuration not found");e("SET_VARIANT_CONFIGURATION",i),e("SET_STEP",1)},async fetchVariantConfigurations({commit:e},t){const a=await l(t),{data:i}=await a.json();D(i),e("SET_VARIANT_CONFIGURATIONS",i)},async fetchVariantConfigurationTypeFields({commit:e},t){const a=await o(t),{data:i}=await a.json();e("SET_VARIANT_CONFIGURATION_TYPE_FIELDS",i)},async toggleAllSelectedFields({commit:e,getters:t,state:a}){if(t.isAllFieldsSelected)return e("SET_VARIANT_CONFIGURATION_FIELDS",[]);const i=[];a.variantConfigurationTypeFields.forEach(e=>{i.push(e.handle)}),e("SET_VARIANT_CONFIGURATION_FIELDS",i)},async toggleAllSelectedValues({commit:e,getters:t,state:a},i){const s=t.fieldValuesByHandle[i];if(!s.length)return;let n=[];const r=a.variantConfiguration.values;n=t.isAllValuesSelected(i)?r.filter(e=>-1===s.indexOf(e)):[...r,...s],e("SET_VARIANT_CONFIGURATION_VALUES",n)},async nextStep({commit:e,getters:t,state:a,dispatch:i}){const{rules:s}=t.currentStepState;if(!await i("validate",{schema:s,values:a.variantConfiguration}))return;!1!==await F.emit("form-submission")&&(a.step>=a.totalSteps||e("SET_STEP",a.step+1))},async prevStep({commit:e,state:t}){t.step<0||e("SET_STEP",t.step-1)},async menuStep({commit:e,dispatch:t}){t("resetForm")},async validate({commit:e,getters:t,state:a},{schema:i,values:s}){try{e("SET_FORM_ERRORS",{}),await i.validate(s,{abortEarly:!1})}catch(t){if(!(t instanceof m.a))throw t;return t.inner&&t.inner.forEach(t=>{e("SET_FORM_ERRORS",{...a.formErrors,[t.path]:t.message})}),!1}return!0},async createNewVariantConfiguration({commit:e,dispatch:t}){await t("clearFormErrors"),e("SET_VARIANT_CONFIGURATION",R())},async clearFormErrors({commit:e}){e("SET_FORM_ERRORS",{})}},getters:{allowedTypes:e=>v.concat(e.hasDimensions?h:[]),settingsByType:e=>t=>e.variantConfiguration.settings[t]||{},isAllFieldsSelected(e){const t=e.variantConfigurationTypeFields.map(e=>e.handle);return t.filter(t=>e.variantConfiguration.fields.includes(t)).length===t.length},isAllValuesSelected:(e,t)=>a=>{const i=t.fieldValuesByHandle[a];return i.filter(t=>e.variantConfiguration.values.includes(t)).length===i.length},selectedFields:e=>e.variantConfigurationTypeFields.filter(t=>e.variantConfiguration.fields.includes(t.handle)),selectedOptionsByFieldHandle(e,t){const a={};return t.selectedFields.forEach(t=>{a[t.handle]=[],t.values.forEach(i=>{e.variantConfiguration.values.includes(i.value)&&a[t.handle].push(i)})}),a},fieldValuesByHandle(e){const t={};return e.variantConfigurationTypeFields.forEach(e=>{t[e.handle]=e.values.map(({value:e})=>e)}),t},optionValuesById(e){const t={};return e.variantConfigurationTypeFields.forEach(e=>{e.values.forEach(e=>{t[e.value]=e.label})}),t},selectedOptionValuesByFieldHandle(e,t){const a={};return t.selectedFields.forEach(t=>{a[t.handle]=[],t.values.forEach(i=>{e.variantConfiguration.values.includes(i.value)&&a[t.handle].push(i.value)})}),a},currentStepState:(e,t)=>t.stepState(e.step),stepState:(e,t)=>e=>{switch(e){case 0:default:return E.indexStep;case 1:return E.nameStep;case 2:return E.fieldsStep;case 3:return E.valuesStep;case 4:return E.settingsStep;case 5:return E.generateStep}},defaultSettings:()=>x}}),B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"body"},[a("div",{staticClass:"content-summary"},[a("AppHeader",{attrs:{title:e.state.header.title,subtitle:e.state.header.subtitle}})],1),e._v(" "),e.isLoading?a("AppLoading"):e._e(),e._v(" "),e.isLoading?e._e():a(e.state.component,e._b({tag:"component"},"component",{hasDimensions:e.hasDimensions},!1))],1),e._v(" "),a("AppFooter",{attrs:{isLoading:e.isLoading,isSubmitting:e.isSubmitting,isCompleted:e.isCompleted,priBtnText:e.state.footer.priBtnText,secBtnText:e.state.footer.secBtnText,step:e.step},on:{"close-modal":e.handleCloseModal}})],1)};B._withStripped=!0;var U=function(){var e=this.$createElement;this._self._c;return this._m(0)};U._withStripped=!0;var G={},k=a("KHd+"),L=Object(k.a)(G,U,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{display:"flex","align-items":"center"}},[this._v("\n  Loading...\n  "),t("span",{staticClass:"spinner"})])}],!1,null,null,null);L.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/AppLoading.vue";var H=L.exports,M=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h1",{staticStyle:{"font-size":"20px","font-weight":"bold"}},[this._v("\n    "+this._s(this.title)+"\n  ")]),this._v(" "),t("p",{staticStyle:{"margin-bottom":"2rem !important"}},[this._v("\n    "+this._s(this.subtitle)+"\n  ")])])};M._withStripped=!0;var q={props:{title:String,subtitle:String}},Y=Object(k.a)(q,M,[],!1,null,null,null);Y.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/AppHeader.vue";var J=Y.exports,Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"footer"},[e.step>0?a("div",{staticClass:"buttons left"},[a("button",{staticClass:"btn icon nav",on:{click:e.menuStep}},[e._v("Menu")])]):e._e(),e._v(" "),e.isCompleted?a("div",{staticClass:"buttons right"},[a("button",{staticClass:"btn submit",on:{click:function(t){return e.$emit("close-modal")}}},[e._v("Finish")])]):a("div",{staticClass:"buttons right"},[a("button",{staticClass:"btn",on:{click:e.handleSecBtnClick}},[e._v("\n      "+e._s(e.secBtnText)+"\n    ")]),e._v(" "),a("button",{staticClass:"btn submit",class:{disabled:e.isLoading,add:e.isSubmitting,icon:e.isSubmitting,loading:e.isSubmitting},attrs:{disabled:e.isLoading||e.isSubmitting},on:{click:e.nextStep}},[e._v("\n      "+e._s(e.priBtnText)+"\n    ")])])])};Q._withStripped=!0;var K={props:{isLoading:Boolean,isSubmitting:Boolean,isCompleted:Boolean,priBtnText:String,secBtnText:String,step:Number},methods:{...Object(s.b)(["nextStep","prevStep","menuStep"]),handleSecBtnClick(){0===this.step?this.$emit("close-modal"):this.prevStep()}}},z=Object(k.a)(K,Q,[],!1,null,null,null);z.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/AppFooter.vue";var W=z.exports,X=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("table",{ref:"table",staticClass:"display data",attrs:{id:"variant_configurations"}},[this._m(0),this._v(" "),t("tbody")])])};X._withStripped=!0;var Z={data:()=>({dt:null}),computed:{...Object(s.e)({productId:e=>e.productId,variantConfigurations:e=>e.variantConfigurations,dtData(){const e=[];return this.variantConfigurations.forEach(t=>{const a=null==t.dateUpdated?null:new Date(t.dateUpdated).toLocaleDateString();e.push({id:t.id,name:t.title,num:t.numberOfVariants,date:a})}),e}})},created(){F.once("form-submission",this.createNewVariantConfiguration)},mounted(){const e=this;this.$nextTick(()=>{this.dt=$(this.$refs.table).DataTable({data:this.dtData,columns:[{data:"id",createdCell:function(e,t,a,i,s){$(e).addClass("variant-cell")}},{data:"name",createdCell:function(e,t,a,i,s){$(e).addClass("variant-cell")}},{data:"num",createdCell:function(e,t,a,i,s){$(e).addClass("variant-cell")}},{data:"date",createdCell:function(e,t,a,i,s){$(e).addClass("variant-cell")}},{name:"control",searchable:!1,title:"",orderable:!1,defaultContent:'<input type="button" class="delete btn" value="Delete">',createdCell:function(t,a,i,s,n){$(t).on("click","input",async()=>{if(confirm(`Are you sure you want to permanently delete the ${i.name} variant configuration?`)){e.setIsLoading(!0);try{await e.deleteVariantConfiguration(i.id);await e.fetchVariantConfigurations({productId:e.productId})}catch(e){console.error(e)}finally{e.resetForm(),e.setIsLoading(!1)}}})}}]}),$(".dataTable").on("click",".variant-cell",(function(){const t=e.dt.row(this).data();e.clearFormErrors(),e.setCurrentVariantConfigurationById(t.id)}))})},methods:{...Object(s.b)(["setCurrentVariantConfigurationById","createNewVariantConfiguration","clearFormErrors","deleteVariantConfiguration","resetForm","fetchVariantConfigurations","fetchVariantConfigurationTypeFields"]),...Object(s.d)({setIsLoading:"SET_IS_LOADING"})},beforeDestroy(){this.dt.destroy(),F.off("form-submission",this.createNewVariantConfiguration)}},ee=Object(k.a)(Z,X,[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",[e._v("ID")]),e._v(" "),a("th",[e._v("Name")]),e._v(" "),a("th",[e._v("Number of Variants")]),e._v(" "),a("th",[e._v("Last Updated")]),e._v(" "),a("th")])])}],!1,null,null,null);ee.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/IndexStep.vue";var te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"field width-100"},[e._m(0),e._v(" "),e._m(1),e._v(" "),a("div",{staticClass:"input ltr",class:{errors:e.errors.title}},[a("textarea",{staticClass:"nicetext text",staticStyle:{"min-height":"32px"},attrs:{id:"configuration-name",name:"title",rows:"1",cols:"50",placeholder:""},on:{input:function(t){return e.handleInput(t.target.value)},keydown:function(t){return e.handleEnterKey(t)}}},[e._v(e._s(e.title))]),e._v(" "),e.errors.title?a("ul",{staticClass:"errors"},[a("li",[e._v(e._s(e.errors.title))])]):e._e()])])};ae._withStripped=!0;var ie={computed:Object(s.e)({title:e=>e.variantConfiguration.title,errors:e=>e.formErrors}),methods:{...Object(s.d)({setTitle:"SET_VARIANT_CONFIGURATION_TITLE"}),...Object(s.b)(["validate","nextStep"]),async handleInput(e){const{rules:t}=S;await this.validate({values:{title:e},schema:t}),this.setTitle(e)},handleEnterKey(e){"Enter"===e.key&&(e.preventDefault(),this.nextStep())}}},se=Object(k.a)(ie,ae,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"heading"},[t("label",{attrs:{for:"configuration-name"}},[this._v("Name")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"instructions",attrs:{id:"configuration-name-instructions"}},[t("p",[this._v('Give your configuration a name e.g. "Accent Colours"')])])}],!1,null,null,null);se.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/NameStep.vue";var ne=se.exports,re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"field width-100"},[a("div",{staticClass:"heading"},[a("label",{attrs:{for:"configuration-fields"}},[e._v("Fields\n      "),a("a",{staticStyle:{"font-size":"11px","font-weight":"normal","margin-left":"2px"},attrs:{href:"#"},on:{click:e.toggleAllSelectedFields}},[e._v(e._s(e.isAllSelected?"Unselect all":"Select all"))])])]),e._v(" "),a("div",{staticClass:"input ltr",class:{errors:e.errors.fields}},[a("fieldset",{staticClass:"checkbox-group"},e._l(e.fields,(function(t){return a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.variantFields,expression:"variantFields"}],staticClass:"checkbox",attrs:{type:"checkbox",name:"fields[]",id:"fields-"+t.handle},domProps:{value:t.handle,checked:Array.isArray(e.variantFields)?e._i(e.variantFields,t.handle)>-1:e.variantFields},on:{change:function(a){var i=e.variantFields,s=a.target,n=!!s.checked;if(Array.isArray(i)){var r=t.handle,l=e._i(i,r);s.checked?l<0&&(e.variantFields=i.concat([r])):l>-1&&(e.variantFields=i.slice(0,l).concat(i.slice(l+1)))}else e.variantFields=n}}}),e._v(" "),a("label",{attrs:{for:"fields-"+t.handle}},[e._v("\n          "+e._s(t.name)+"\n        ")])])})),0),e._v(" "),e.errors.fields?a("ul",{staticClass:"errors"},[a("li",[e._v(e._s(e.errors.fields))])]):e._e()])])};re._withStripped=!0;var le={computed:{...Object(s.e)({fields:e=>e.variantConfigurationTypeFields,errors:e=>e.formErrors}),...Object(s.c)({isAllSelected:"isAllFieldsSelected"}),variantFields:{get(){return this.$store.state.variantConfiguration.fields},async set(e){const{rules:t}=y;await this.validate({values:{fields:e},schema:t}),this.setFields(e)}}},methods:{...Object(s.d)({setFields:"SET_VARIANT_CONFIGURATION_FIELDS"}),...Object(s.b)(["toggleAllSelectedFields","validate"])}},oe=Object(k.a)(le,re,[],!1,null,null,null);oe.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/FieldsStep.vue";var ce=oe.exports,de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.selectedFields,(function(t){return a("div",{staticClass:"field width-100"},[a("div",{staticClass:"heading"},[a("label",{attrs:{for:"configuration-fields"}},[e._v(e._s(t.name)+"\n        "),a("a",{staticStyle:{"font-size":"11px","font-weight":"normal","margin-left":"2px"},attrs:{href:"#"},on:{click:function(a){return e.handleToggleValues(t.handle)}}},[e._v(e._s(e.isAllSelected(t.handle)?"Unselect all":"Select all"))])])]),e._v(" "),a("div",{staticClass:"input ltr",class:{errors:e.errors.values}},[a("fieldset",{staticClass:"checkbox-group",staticStyle:{display:"flex","flex-wrap":"wrap"}},e._l(t.values,(function(t){var i=t.label,s=t.value;return a("div",{staticStyle:{width:"25%"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.values,expression:"values"}],staticClass:"checkbox",attrs:{type:"checkbox",id:"fields-"+s,name:"fields[]"},domProps:{value:s,checked:Array.isArray(e.values)?e._i(e.values,s)>-1:e.values},on:{change:function(t){var a=e.values,i=t.target,n=!!i.checked;if(Array.isArray(a)){var r=s,l=e._i(a,r);i.checked?l<0&&(e.values=a.concat([r])):l>-1&&(e.values=a.slice(0,l).concat(a.slice(l+1)))}else e.values=n}}}),e._v(" "),a("label",{attrs:{for:"fields-"+s}},[e._v("\n            "+e._s(i)+"\n          ")])])})),0),e._v(" "),e.errors.values?a("ul",{staticClass:"errors"},[a("li",[e._v(e._s(e.errors.values))])]):e._e()])])})),0)};de._withStripped=!0;var ue={computed:{...Object(s.e)({fields:e=>e.variantConfigurationTypeFields,errors:e=>e.formErrors,variantValues:e=>e.variantConfiguration.values,variantFields:e=>e.variantConfiguration.fields}),...Object(s.c)({selectedFields:"selectedFields",isAllSelected:"isAllValuesSelected"}),values:{get(){return this.variantValues},async set(e){await this.isValid(e),this.setValues(e)}}},methods:{...Object(s.b)(["toggleAllSelectedValues","validate"]),...Object(s.d)({setValues:"SET_VARIANT_CONFIGURATION_VALUES"}),handleToggleValues(e){this.toggleAllSelectedValues(e),this.isValid(this.variantValues)},async isValid(e){const{rules:t}=T;return await this.validate({values:{values:e},schema:t})}}},pe=Object(k.a)(ue,de,[],!1,null,null,null);pe.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/ValuesStep.vue";var ve=pe.exports,he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.allowedTypes,(function(t,i){return a("div",[a("AppSettings",{attrs:{type:t,hasDimensions:e.hasDimensions}}),e._v(" "),i<e.allowedTypes.length-1?a("hr"):e._e()],1)})),0)};he._withStripped=!0;var fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return"weight"!==e.type||e.hasDimensions?a("div",{staticClass:"field"},[a("div",{staticClass:"heading"},[a("label",[e._v(e._s(e.typeTitle))]),e._v(" "),a("div",{staticClass:"instructions"},[e._v("\n      "+e._s(e.typeInstructions)+"\n    ")])]),e._v(" "),a("div",{staticClass:"input ltr"},[a("fieldset",[a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.method,expression:"method"}],staticClass:"radio",attrs:{type:"radio",id:"settings-"+e.type+"-all",name:"settings["+e.type+"][method]",value:"all"},domProps:{checked:e._q(e.method,"all")},on:{change:function(t){e.method="all"}}}),e._v(" "),a("label",{attrs:{for:"settings-"+e.type+"-all"}},[e._v("Set "+e._s(e.typeTitle)+" for all variants")])]),e._v(" "),"all"===e.method?a("div",{staticClass:"field",staticStyle:{"margin-left":"32px"}},[a("div",{staticClass:"heading"},[a("label",[e._v(e._s(e.typeTitle))])]),e._v(" "),a("div",{staticClass:"input ltr"},[a("div",{staticClass:"flex"},["price"===e.type?a("div",[e._v("$")]):e._e(),e._v(" "),a("input",{staticClass:"nicetext text",attrs:{type:"text"},domProps:{value:e.values.value},on:{input:function(t){return e.setFieldValue("value",t.target.value)}}}),e._v(" "),"weight"===e.type?a("div",[e._v("g")]):e._e(),e._v(" "),e.hasLength?a("div",[e._v("mm")]):e._e()])]),e._v(" "),e.errors["settings."+e.type+".values.value"]?a("ul",{staticClass:"errors"},[a("li",[e._v(e._s(e.errors["settings."+e.type+".values.value"]))])]):e._e()]):e._e(),e._v(" "),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.method,expression:"method"}],staticClass:"radio",attrs:{type:"radio",id:"settings-"+e.type+"-field",name:"settings["+e.type+"][method]",value:"field"},domProps:{checked:e._q(e.method,"field")},on:{change:function(t){e.method="field"}}}),e._v(" "),a("label",{attrs:{for:"settings-"+e.type+"-field"}},[e._v("Set "+e._s(e.typeTitle)+" per field")])]),e._v(" "),"field"===e.method?a("div",{staticClass:"field",staticStyle:{"margin-left":"32px"}},[e._m(0),e._v(" "),a("div",{staticClass:"input ltr"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.field,expression:"field"}],attrs:{name:"",id:""},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.field=t.target.multiple?a:a[0]}}},[a("option",{domProps:{value:null}},[e._v("Select")]),e._v(" "),e._l(e.selectedFields,(function(t){return e.selectedValuesByHandle[t.handle].length?a("option",{domProps:{value:t.handle}},[e._v("\n              "+e._s(t.name)+"\n            ")]):e._e()}))],2)]),e._v(" "),e.errors["settings."+e.type+".field"]?a("ul",{staticClass:"errors"},[a("li",[e._v(e._s(e.errors["settings."+e.type+".field"]))])]):e._e(),e._v(" "),e._l(e.selectedValuesByHandle[e.field],(function(t){var i=t.label,s=t.value;return e.field?a("div",{staticClass:"field"},[a("div",{staticClass:"heading"},[a("label",[e._v(e._s(i))])]),e._v(" "),a("div",{staticClass:"input ltr"},[a("div",{staticClass:"flex"},["price"===e.type?a("div",[e._v("$")]):e._e(),e._v(" "),a("input",{staticClass:"nicetext text",attrs:{type:"text"},domProps:{value:e.values[s]},on:{input:function(t){return e.setFieldValue(s,t.target.value)}}}),e._v(" "),"weight"===e.type?a("div",[e._v("g")]):e._e(),e._v(" "),e.hasLength?a("div",[e._v("mm")]):e._e()])]),e._v(" "),e.errors["settings."+e.type+".values."+s]?a("ul",{staticClass:"errors"},[a("li",[e._v(e._s(e.errors["settings."+e.type+".values."+s]))])]):e._e()]):e._e()}))],2):e._e(),e._v(" "),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.method,expression:"method"}],staticClass:"radio",attrs:{type:"radio",id:"settings-"+e.type+"-skip",name:"settings["+e.type+"][method]",value:"skip"},domProps:{checked:e._q(e.method,"skip")},on:{change:function(t){e.method="skip"}}}),e._v(" "),a("label",{attrs:{for:"settings-"+e.type+"-skip"}},[e._v("Skip "+e._s(e.typeTitle))])])]),e._v(" "),e.errors["settings."+e.type+".method"]?a("ul",{staticClass:"errors"},[a("li",[e._v(e._s(e.errors["settings."+e.type+".method"]))])]):e._e()])]):e._e()};fe._withStripped=!0;var me={props:{type:{type:String,required:!0},hasDimensions:{type:Boolean,required:!0}},computed:{hasLength(){return["length","height","width"].includes(this.type)},...Object(s.e)({variantSettings(e){return e.variantConfiguration.settings[this.type]||this.defaultSettings},errors:e=>e.formErrors}),...Object(s.c)({defaultSettings:"defaultSettings",selectedFields:"selectedFields",selectedValuesByHandle:"selectedOptionsByFieldHandle"}),typeTitle(){const e=Craft.t("craft-commerce-untitled",this.type);return e.charAt(0).toUpperCase()+e.slice(1)},typeInstructions(){switch(this.type){case"sku":return`Use ${this.templateVars} to dynamically set ${this.typeTitle} from field values`;default:return""}},templateVars(){return this.selectedFields.map(e=>`{${e.handle}}`).join(", ")},method:{get(){return this.variantSettings.method},async set(e){const t={...this.variantSettings,method:e};this.setSettingsType({type:this.type,data:t})}},field:{get(){return this.variantSettings.field},async set(e){const t={...this.variantSettings,field:e};this.setSettingsType({type:this.type,data:t})}},values:{get(){return this.variantSettings.values},async set(e){const t={...this.variantSettings,values:e};this.setSettingsType({type:this.type,data:t})}}},methods:{...Object(s.b)(["validate"]),...Object(s.d)({setSettingsType:"SET_VARIANT_CONFIGURATION_SETTINGS_TYPE"}),setFieldValue(e,t){const a={},i=this.variantSettings.values;null==t||""==t?delete i[e]:a[e]=t;const s={...this.variantSettings,values:{...i,...a}};this.setSettingsType({type:this.type,data:s})}}},_e=Object(k.a)(me,fe,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"heading"},[t("label",[this._v("Choose a field")])])}],!1,null,null,null);_e.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/AppSettings.vue";var ge=_e.exports,Se={props:{hasDimensions:{type:Boolean,required:!0}},created(){F.once("form-submission",this.saveVariantConfiguration)},computed:{...Object(s.c)(["allowedTypes"])},methods:{...Object(s.b)(["saveVariantConfiguration"])},beforeDestroy(){F.off("form-submission",this.saveVariantConfiguration)},components:{AppSettings:ge}},ye=Object(k.a)(Se,he,[],!1,null,null,null);ye.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/SettingsStep.vue";var Te=ye.exports,Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isGenerating?a("div",[a("h2",[e._v("Hold Tight!")]),e._v(" "),e._m(2)]):a("div",[a("h2",{staticStyle:{"margin-bottom":"5px"}},[e._v("Config Summary")]),e._v(" "),a("div",{staticStyle:{"margin-bottom":"16px"}},[e._v("The following config will be saved:")]),e._v(" "),a("div",{staticClass:"field",staticStyle:{"margin-bottom":"16px 0"}},[e._m(0),e._v(" "),a("div",{staticStyle:{"margin-bottom":"16px"}},[e._v(e._s(e.variantConfiguration.title))]),e._v(" "),e._l(e.selectedFields,(function(t){return a("div",[a("div",{staticStyle:{"margin-bottom":"5px","font-weight":"bold",color:"#606d7b"}},[e._v("\n        "+e._s(t.name)+"\n      ")]),e._v(" "),a("ul",{staticStyle:{margin:"0 0 16px 16px","list-style-type":"disc"}},e._l(e.selectedOptionsByFieldHandle[t.handle],(function(t){var i=t.label;t.value;return a("li",[e._v("\n          "+e._s(i)+"\n        ")])})),0)])})),e._v(" "),e._m(1),e._v(" "),e._l(e.allowedTypes,(function(t){return a("ul",{staticStyle:{margin:"0 0 0 16px","list-style-type":"disc"}},["all"===e.variantConfiguration.settings[t].method?a("li",[e._v("\n        "+e._s(e.getTitle(t))+" - "+e._s("price"===t?"$":"")+e._s(e.variantConfiguration.settings[t].values.value)+"\n        for all variants\n      ")]):e._e(),e._v(" "),"field"===e.variantConfiguration.settings[t].method?[a("li",[e._v(e._s(e.getTitle(t))+" - Per field")]),e._v(" "),a("ul",{staticStyle:{"margin-left":"16px","list-style-type":"revert"}},e._l(e.variantConfiguration.settings[t].values,(function(i,s){return"value"!==s?a("li",[e._v("\n            "+e._s(e.optionValuesById[s])+" - "+e._s("price"===t?"$":"")+e._s(i)+"\n          ")]):e._e()})),0)]:e._e(),e._v(" "),"skip"===e.variantConfiguration.settings[t].method?a("li",[e._v("\n        "+e._s(e.getTitle(t))+" - Skipped\n      ")]):e._e()],2)}))],2)])};Ce._withStripped=!0;var be={data:()=>({isGenerating:!1}),computed:{...Object(s.e)({variantConfiguration:e=>e.variantConfiguration}),...Object(s.c)(["selectedFields","selectedOptionsByFieldHandle","fieldValuesByHandle","optionValuesById","allowedTypes"])},created(){F.once("form-submission",this,this.handleGenerateVariants)},beforeDestroy(){F.off("form-submission",this.handleGenerateVariants)},methods:{...Object(s.b)(["generateVariants"]),...Object(s.d)({setIsCompleted:"SET_IS_COMPLETED"}),getTitle:(e="")=>e.charAt(0).toUpperCase()+e.slice(1),async handleGenerateVariants(){await this.generateVariants(this.variantConfiguration.id),this.setIsCompleted(),this.isGenerating=!0}}},Ie=Object(k.a)(be,Ce,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"heading"},[t("label",[this._v("Title")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"heading"},[t("label",[this._v("Settings")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("\n    Please wait while your variants are generated."),t("br"),this._v("\n    This can take several minutes and you can monitor progress on the queue\n    jobs page.\n  ")])}],!1,null,null,null);Ie.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/Steps/GenerateStep.vue";var Oe=Ie.exports,Ee={props:{productId:Number,productTypeId:Number,variantConfigurationTypeId:Number,$modal:Object,hasDimensions:Boolean},computed:{...Object(s.e)({isLoading:e=>e.ui.isLoading,isSubmitting:e=>e.ui.isSubmitting,isCompleted:e=>e.ui.isCompleted,step:e=>e.step}),...Object(s.c)({state:"currentStepState"})},async created(){this.setIsLoading(!0),this.setProductId(this.productId),this.setProductTypeId(this.productTypeId),this.setTypeId(this.variantConfigurationTypeId),this.setHasDimensions(this.hasDimensions),await this.fetchVariantConfigurations({productId:this.productId}),await this.fetchVariantConfigurationTypeFields({productTypeId:this.productTypeId}),this.setIsLoading(!1)},methods:{...Object(s.b)(["fetchVariantConfigurations","fetchVariantConfigurationTypeFields"]),...Object(s.d)({setIsLoading:"SET_IS_LOADING",setProductId:"SET_PRODUCT_ID",setProductTypeId:"SET_PRODUCT_TYPE_ID",setTypeId:"SET_TYPE_ID",setHasDimensions:"SET_HAS_DIMENSIONS"}),handleCloseModal(){this.$modal.hide()}},components:{AppLoading:H,AppHeader:J,AppFooter:W,IndexStep:te,NameStep:ne,FieldsStep:ce,ValuesStep:ve,SettingsStep:Te,GenerateStep:Oe}},Ae=Object(k.a)(Ee,B,[],!1,null,null,null);Ae.options.__file="src/assetbundles/craftcommerceuntitled/src/js/components/App.vue";var Ne=Ae.exports;!function(e){e.fn.dataTable.ext.classes.sPageButton=e.fn.dataTable.ext.classes.sPageButton+" btn",e.fn.dataTable.ext.classes.sPageButtonActive="active",e.fn.dataTable.ext.classes.sFilterInput="text dataTables_filter__input",e.fn.dataTable.ext.classes.sSortAsc="ordered asc",e.fn.dataTable.ext.classes.sSortColumn="ordered",e.fn.dataTable.ext.classes.sSortDesc="ordered desc",Craft.CommerceUntitled=Garnish.Base.extend({settings:{productId:null,productTypeId:null,variantConfigurationTypeId:null,productVariantType:"standard",hasDimensions:!1},$dt:e(),init(t){this.settings=e.extend({},Craft.CommerceUntitled.defaults,t),"standard"!==this.settings.productVariantType&&(this.initEditBtn(),this.initDataTables()),this.handleVariantTypeChange()},initEditBtn(){const t=e(this.getEditBtnHtml());e("#header").find(".btngroup:first").before(t),t.on("click",e=>{e.preventDefault(),new Craft.VariantConfigurationModal({productId:this.settings.productId,productTypeId:this.settings.productTypeId,variantConfigurationTypeId:this.settings.variantConfigurationTypeId,hasDimensions:!!this.settings.hasDimensions,onClose:e=>{e.$destroy(),P.dispatch("resetForm"),this.$dt.ajax.reload()}})})},initDataTables(){const t=this.settings.productId;this.$dt=e("#configurable-variants").DataTable({autoWidth:!1,ajax:"/craft-commerce-untitled/api/v1/variants?productId="+t})},handleVariantTypeChange(){const t=this.settings.productId;e("#variant-type-field").find("select").on("change",e=>{const a=e.target.value;u(t,{variantType:a}).then(()=>{window.location.reload()})})},getEditBtnHtml:()=>'<button class="btn secondary">Edit Configurations</button>'}),Craft.VariantConfigurationModal=Garnish.Modal.extend({settings:{productId:null,productTypeId:null,variantConfigurationTypeId:null,hasDimensions:!1,onClose:()=>{}},closeOtherModals:!0,shadeClass:"modal-shade dark",init(t){this.setSettings(t,Craft.VariantConfigurationModal.defaults),this.$container=e('<div class="modal elementselectormodal">\n          <div id="variant-configuration-modal-container" style="height: 100%; overflow-y: auto; overscroll-behavior: contain;">\n            <div id="variant-configuration-app" />\n          </div>\n        </div>').appendTo(Garnish.$bod);const a=new i.a({el:"#variant-configuration-app",store:P,render:e=>e(Ne,{props:{productId:this.settings.productId,productTypeId:this.settings.productTypeId,variantConfigurationTypeId:this.settings.variantConfigurationTypeId,hasDimensions:!!this.settings.hasDimensions,$modal:this}})});this.on("hide",()=>{this.settings.onClose(a)}),this.base(this.$container,t)}})}(jQuery)}},[["ZpdD",1,2]]]);